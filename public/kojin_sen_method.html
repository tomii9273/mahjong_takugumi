<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="keyword" content="麻雀, 麻将, 大会, 卓組, 組み合わせ" />
    <title>個人戦 卓組作成方法 - 麻雀大会用卓組表</title>
  </head>
  <body bgcolor="#e0ffe0">
    <h1>個人戦 卓組作成方法</h1>

    <h2>条件</h2>
    <ul>
      <li>n 卓 4n 人の選手がいる。</li>
      <li>どの選手も、同じ相手と複数回同卓しない。</li>
    </ul>

    <h2>方法</h2>

    <p>
      上記の条件のもとで<b>なるべく対戦数が多くなる</b>ように、いくつかの方法を使って作成しました。<br />
      3 卓以下の場合、2 戦目の時点で複数回同卓しない条件を満たせないため、4 卓以上について考えました。
    </p>

    <table border="1">
      <tr align="left">
        <th>卓数</th>
        <th>方法</th>
        <th>備考</th>
      </tr>
      <tr align="left">
        <td>4, 7, 10, 13, 16, 19, 22, 25, 28</td>
        <td><a href="souatari_sen_method.html">総当たり戦の作成方法</a></td>
        <td>「3n+1」のもの</td>
      </tr>
      <tr align="left">
        <td>5</td>
        <td><a href="4team_sen_method.html">4チーム戦の作成方法</a></td>
        <td></td>
      </tr>
      <tr align="left">
        <td>11, 12, 14, 15, 17, 18, 20, 21, 23, 24, 26, 27, 29, 30</td>
        <td>4チーム戦にチーム内対戦を加える方法 <b>次項で説明します</b></td>
        <td>11 以上で「3n+1」でないもの</td>
      </tr>
      <tr align="left">
        <td>6</td>
        <td><a href="http://wandm.syakuhati.com/tabling.html#trio">リンク先</a>参照</td>
        <td>当サイトの作者が作ったものではないです</td>
      </tr>
      <tr align="left">
        <td>8, 9</td>
        <td>(準備中、今後更新します)</td>
        <td></td>
      </tr>
    </table>

    <h2>4チーム戦にチーム内対戦を加える方法</h2>

    <p>
      まず、作成したい卓数の 4 チーム戦の (なるべく対戦数の多い) 卓組を用意します。<br />参考:
      <a href="4team_sen_method.html">4チーム戦 卓組作成方法</a><br />
      この際、選手番号を「チーム A の 1 戦目の卓番号順 → チーム B の 1 戦目の卓番号順 → …」に振ります。<br />
      画像では、11 卓の場合の例を示します。3 ～ 10 戦目は省略しています。
    </p>

    <img src="images/kojin_00.png" alt="11 卓 44 人 11 戦の 4 チーム戦の卓組" />

    <p>
      この 4
      チーム戦の卓組に<b>うまく「チーム内対戦」を何戦か加える</b>ことで対戦数を増やし、個人戦用の卓組として使えるようにする、という方針で進めます。<br />
      そのために、以下のような「チーム内対戦」用の卓組を考えます。この卓組の作り方やどのようなものが理想的かは、後述します。
    </p>

    <ul>
      <li>n 人の選手がいる。</li>
      <li>どの選手も、同じ相手と複数回同卓しない。</li>
      <li>各選手は最大 1 回まで、参加しない対戦枠があってもよい。</li>
    </ul>

    <p>
      11 卓の場合は 11 人の卓組になり、以下のものが一例です。以降の説明の都合上、卓番号に数字でなく A, B を使っています。<br />
      空欄は「参加しない対戦枠」を表します。選手 8 のみ 2 戦の両方に参加していますが、このような選手がいても問題ありません。
    </p>

    <img src="images/kojin_01.png" alt="11 人の「チーム内対戦」用の卓組" />

    <p>これを 4 チーム戦の卓組に追加します。 下図では、黒太枠の部分に追加しました。1A, 1B などは卓番号です。</p>

    <img src="images/kojin_02.png" alt="11 卓の 4 チーム戦の卓組にチーム内対戦を追加したもの" />

    <p>
      次に、追加した部分の空欄を解消を目指します。<br />
      各選手について、空欄がある場合は、(4 チーム戦の) <b>1 戦目に書かれていた卓番号を空欄に書き込みます。そして、1 戦目を削除します。</b><br />
      最初に選手番号を「チーム A の 1 戦目の卓番号順 → チーム B の 1 戦目の卓番号順 → …」に振っているため、空欄を埋めた部分の対戦相手は 1
      戦目と同じです。そのため、同じ相手と複数回同卓することはありません。<br />
    </p>

    <img src="images/kojin_03.png" alt="11 卓での空欄の解消" />

    <p>
      最後に、卓番号と対戦番号を適切に振り直せば、個人戦の卓組が完成します。<br />画像の例では、11 卓 11 戦の 4 チーム戦の卓組と、11
      人の「チーム内対戦」の卓組を使うことで、11 卓 12 戦の個人戦の卓組ができました。
    </p>

    <img src="images/kojin_04.png" alt="11 卓での卓番号と対戦番号の振り直し" />

    <p>
      なお、「チーム内対戦」用の卓組に空欄がない場合は、空欄を埋める操作を行わないので、4 チーム戦の 1 戦目を削除する必要がありません。これは卓数が 4
      の倍数の場合に起こり得ます。<br />下の画像は 20 卓の例です。「チーム内対戦」に
      <a href="kojin_sen/5taku_20nin_5sen_kojin.txt">5 卓 20 人 5 戦の個人戦の卓組</a>を使用しました。
    </p>

    <img src="images/kojin_05.png" alt="20 卓の場合の具体例" />

    <h2>「チーム内対戦」用の卓組について</h2>
    <h3>どのようなものが理想的か</h3>

    <p>条件を再掲します。</p>

    <ul>
      <li>n 人の選手がいる。</li>
      <li>どの選手も、同じ相手と複数回同卓しない。</li>
      <li>各選手は最大 1 回まで、参加しない対戦枠 (空欄) があってもよい。</li>
    </ul>

    <p>
      これを満たす卓組は複数パターン考えられる場合がありますが、以下のように定義する
      <b>k の値が、n 卓の 4 チーム戦の卓組に追加したときに最終的に増やせる対戦数</b>を表しており、この k
      が大きいほど、理想的な卓組ということになります。
    </p>

    <ul>
      <li>(ア) 参加しない対戦枠がある選手が一人もいない場合、k = (対戦数 (表の横軸の長さ))</li>
      <li>(イ) 参加しない対戦枠がある選手が一人でもいる場合、k = (対戦数 (表の横軸の長さ)) - 1</li>
    </ul>

    <p>
      下の画像は 12 人の場合の (ア) と (イ) それぞれの例です。この 2 つを比較すると、右側の (イ) の方が k が大きいです。<br /><br />
      その他に、k について以下のことが言えます。
    </p>

    <ul>
      <li>k は、参加する対戦枠の最も少ない選手の対戦回数に等しい。</li>
      <li><b>「k の理想値」(*) は [(n - 1) / 3]</b> である。([] は中身の小数部分の切り捨てを意味する。)</li>
      <li>
        (*) この値を達成できる k が必ずしも存在するとは限らないが、これを超える k は絶対に存在しないことが示せるもの。
        <details>
          <summary>証明</summary>
          <p>
            「参加する対戦枠の最も少ない選手」1 人の立場で考える。<br />
            自分以外の選手の総数は n - 1 人である。1 回の対戦で同卓する相手は 3 人である。<br />
            そのため、(n - 1) / 3 戦目 (小数部分は切り捨て) までは、うまく対戦を組めば同じ相手との複数回の同卓を防げる可能性がある。<br />
            しかし、その次の対戦には、一度同卓した相手が必ず含まれることになる。(参考:
            <a href="https://ja.wikipedia.org/wiki/%E9%B3%A9%E3%81%AE%E5%B7%A3%E5%8E%9F%E7%90%86">鳩の巣原理 - Wikipedia</a>)
          </p>
        </details>
      </li>
    </ul>

    <img src="images/kojin_06.png" alt="12 人の「チーム内対戦」用の卓組の例" />

    <h3>「チーム内対戦」用の卓組の簡単な作り方</h3>

    <p>
      人数 n を 4 で割った余りに応じて、以下のような簡単な作り方があります。<br />
      この方法で前述の「k の理想値」を達成できる場合もあります。<br />
    </p>

    <h4>余り 0 (n が 4 の倍数) の場合</h4>

    <p><b>n 人 (n / 4 卓) の個人戦の卓組</b>をそのまま使用できます。</p>

    <h4>余り 1 の場合</h4>

    <p>
      <b>[n / 4] 卓の 4 チーム戦の卓組</b>を用意します。その際、(どの選手も同じ相手と複数回同卓しないことは前提で、それに加え)
      同じ卓を複数回使用する人がいないように、各対戦の卓番号を調整します。<br /><a href="4team_sen_method.html">4チーム戦 卓組作成方法</a>の ①
      で作ったものを使う場合、全員の卓番号を 2 戦目は +1、3 戦目は +2、… とずらすことでうまくいきます。<br />
      他の方法で作ったものを使う場合、うまく調整できないことがありますが、その場合は調整できない対戦を削除します。<br />
      その後、以下の操作を行います。
    </p>
    <ol>
      <li>4 チーム戦の卓組の末尾に 1 人を付け足す。(これで合計が n 人になる)</li>
      <li>付け足した 1 人の全ての対戦に「卓番号 1」を記入する。</li>
      <li>
        1 チーム目の全ての対戦の「卓番号
        1」を空欄に書き換える。(あらかじめ同じ卓を複数回使用する人がいないようにしたので、ここで空欄が複数個ある人はいない。)
      </li>
    </ol>

    <p>
      操作後も、どの選手も同じ相手と複数回同卓しない状態は維持されています。<br />
      下の画像は、n = 21 の場合の例です。5 卓の 4 チーム戦の卓組を元にしました。
    </p>

    <img src="images/kojin_07.png" alt="5 卓の 4 チーム戦の卓組を元に 21 人の「チーム内対戦」用の卓組を作る例" />

    <h4>余り 2 の場合</h4>

    <p>
      <b>[n / 4] 卓の 4 チーム戦の卓組</b>を用意し、同じ卓を複数回使用する人がいないように、各対戦の卓番号を調整するところまでは「余り 1
      の場合」と同じです。<br />その後、以下の操作を行います。
    </p>
    <ol>
      <li>4 チーム戦の卓組の末尾に 2 人を付け足す。(これで合計が n 人になる)</li>
      <li>付け足した 1 人目の全ての対戦に「卓番号 1」を記入する。</li>
      <li>付け足した 2 人目の全ての対戦に「卓番号 2」を記入する。</li>
      <li>1 チーム目の全ての対戦の「卓番号 1」を空欄に書き換える。</li>
      <li>2 チーム目の全ての対戦の「卓番号 2」を空欄に書き換える。</li>
    </ol>

    <p>
      操作後も、どの選手も同じ相手と複数回同卓しない状態は維持されています。<br />
      下の画像は、n = 22 の場合の例です。5 卓の 4 チーム戦の卓組を元にしました。
    </p>

    <img src="images/kojin_08.png" alt="5 卓の 4 チーム戦の卓組を元に 22 人の「チーム内対戦」用の卓組を作る例" />

    <h4>余り 3 の場合</h4>

    <p><b>(n+1) 人 ((n+1) / 4 卓) の個人戦の卓組</b>を用意し、以下の操作を行います。</p>

    <ol>
      <li>末尾の選手の 1 戦目の卓番号を確認し、1 戦目のその番号をすべて (4 か所) 空欄に書き換える。</li>
      <li>2 戦目以降も同様に行う。</li>
      <li>末尾の選手を削除する。</li>
    </ol>

    <p>
      操作後に、空欄が複数個ある人はいません。また、どの選手も同じ相手と複数回同卓しない状態は維持されています。<br />
      下の画像は、n = 15 の場合の例です。16 人の個人戦の卓組を元にしました。
    </p>

    <img src="images/kojin_09.png" alt="16 人の個人戦の卓組を元に 15 人の「チーム内対戦」用の卓組を作る例" />

    <h2>当サイトでの状況</h2>

    <p>
      当サイト掲載の個人戦用卓組作成に使用した「チーム内対戦」用卓組でも、上記「簡単な作り方」の方法で「k
      の理想値」を達成できる場合はそれを採用し、そうでない場合は、より大きい k について、
    </p>
    <ul>
      <li>プログラムで全探索</li>
      <li>(n が小さい場合) 手で表に数字を書き込んでみる</li>
      <li>達成不可能なことを示す (「(空欄の総数) ≦ n」といった条件から示せる場合がある)</li>
    </ul>
    <p>
      などの方法を行い、卓組を発見できた場合はそれを採用しました。<br />
      なお、全ての n において「k
      をそれよりも大きくすることは不可能である」と示した「チーム内対戦」用卓組を用いているわけではありません。(全探索プログラムが長時間回しても終わらない
      (不可能だという結果も得られない) 場合など)
    </p>

    <h2>補足</h2>

    <ul>
      <li>
        当サイトに掲載している卓組は、上記の方法で作成した後に、以下の操作を複数回行っている場合があります。
        <ul>
          <li>卓番号の入れ替え (例: 1 戦目の卓番号 1 を 2 に、2 を 3 に、3 を 1 に全て書き換えている)</li>
          <li>選手番号の入れ替え</li>
          <li>対戦番号の入れ替え</li>
        </ul>
      </li>
      <li>今後、以下のものを掲載する予定です。</li>
      <ul>
        <li>(「チーム内対戦」用卓組を含めた) 各卓組の作成に使用したソースコード (Python) とその実行時間</li>
        <li>「チーム内対戦」用卓組の「k の理想値」の達成状況</li>
        <li>8, 9 卓個人戦の卓組の作成方法</li>
      </ul>
    </ul>

    <br />
    <a href="index.html#kojin_sen">卓組一覧「個人戦・4人チーム戦用」へ戻る</a>
  </body>
</html>
