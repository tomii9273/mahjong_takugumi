<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="keyword" content="麻雀, 麻将, 大会, 卓組, 組み合わせ" />
    <title>3人麻雀 個人戦 卓組作成方法 - 麻雀大会用卓組表</title>
  </head>
  <body bgcolor="#e0ffe0">
    <h1>3人麻雀 個人戦 卓組作成方法</h1>

    <h2>条件</h2>
    <ul>
      <li>n 卓 4n 人の選手がいる。</li>
      <li>どの選手も、同じ相手と複数回同卓しない。</li>
    </ul>

    <h2>方法</h2>

    <p>
      上記の条件のもとで<b>なるべく対戦数が多くなる</b>ように、いくつかの方法を使って作成しました。<br />
      2 卓以下の場合、2 戦目の時点で複数回同卓しない条件を満たせないため、3 卓以上について考えました。
    </p>

    <table border="1">
      <tr align="left">
        <th>卓数</th>
        <th>方法</th>
        <th>備考</th>
      </tr>
      <tr align="left">
        <td>5, 9, 13</td>
        <td>総当たり戦の作成方法 ① で作成 <b>次項で説明します</b></td>
        <td>「4n+1」形のものの一部</td>
      </tr>
      <tr align="left">
        <td>3, 11, 17, 19, 25</td>
        <td>総当たり戦の作成方法 ② で作成 <b>次項で説明します</b></td>
        <td>奇数の一部</td>
      </tr>
      <tr align="left">
        <td>4</td>
        <td><a href="3g_3team_sen_method.html">3人麻雀 3チーム戦 卓組作成方法</a>で作成</td>
        <td></td>
      </tr>
      <tr align="left">
        <td>7, 15, 21, 23, 27, 29, 6 ～ 30 の偶数</td>
        <td><a href="kojin_sen_method.html">4麻個人戦「4チーム戦にチーム内対戦を加える方法」</a>に近い方法で作成</td>
        <td></td>
      </tr>
    </table>

    <h2>総当たり戦の作成方法</h2>

    <p>卓数が奇数の場合、以下の (前述のものより厳しい) 条件を満たす<b>総当たり戦</b>を組める可能性があります。</p>

    <h3>条件</h3>
    <ul>
      <li>2n+1 卓 6n+3 人の選手がいる。</li>
      <li>3n+1 回の対戦を行う。</li>
      <li>どの選手も、全対戦を行うと (自分以外の) 全員とちょうど 1 回ずつ同卓できる。</li>
      <li>どの選手も、同じ相手と複数回同卓しない。</li>
    </ul>
    <p>
      卓数が偶数の場合は、対戦数にかかわらず、3, 4 番目の条件を同時に満たすことはできません。(自分以外の選手の総数を 2 (= 1 対戦で同卓できる人数)
      で割ると 1 余るため。)
    </p>

    <h3>方法 ①</h3>

    <p>
      <a href="souatari_sen_method.html">(4 人麻雀の) 総当たり戦 卓組作成方法</a>と同様の、円と点を使う方法で、卓組を構成していきます。<br />
      まず、大小 1 つずつの同心円を描きます。各円周を 3n+1 等分するように、点を打ちます。円の中心にも点を打ちます。<br />
      合計 6n+3 個の点を打ちました。これらの点が選手を表します。<br />
      下図は、n = 2 (5 卓 15 人 7 戦) の場合の例です。各円周を 7 等分しています。
    </p>
    <img src="images/3ma_00.png" alt="n = 2 (5 卓 15 人 7 戦) の場合の具体例 (円を描き、点を打った図)" width="15%" height="15%" />

    <p>
      これらの点について、3 個ごとにグループ分けします。<br />
      各グループに属する点同士を、すべて線で結びます。<br />
      線で結ばれていることは同卓を表します。<br />
      下図は 5 卓 15 人 の場合に、5 グループに分ける例です。上段が全て重ねた図、下段が各グループを抜き出した図です。
    </p>
    <img src="images/3ma_01.png" alt="n = 2 (5 卓 15 人 7 戦) の場合の具体例 (線で結び、全て重ねた図)" width="15%" height="15%" /><br />
    <img src="images/3ma_02.png" alt="n = 2 (5 卓 15 人 7 戦) の場合の具体例 (各グループを抜き出した図)" width="50%" height="50%" />

    <p>
      全て重ねた図について、<b>線だけ</b>を、時計回りに 1 / (3n+1) だけ回転させます。<br />
      この操作を 3n 回行い、操作前・1 回目の操作後・2 回目の操作後・...・3n 回目の操作後、の合計 (3n+1) パターンの線の配置を保存します。<br />
      1 回目の操作後の線の配置は 2 戦目の卓組を、2 回目の操作後の線の配置は 3 戦目の卓組を表します。
    </p>
    <img src="images/3ma_03.png" alt="n = 2 (5 卓 15 人 7 戦) の場合の具体例 (回転の操作の図)" width="50%" height="50%" />

    <p>
      保存した線の配置 ((3n+1) パターン)
      を全て重ねます。この際に、完全に重なる線が一つも無いことが、どの選手も同じ相手と複数回同卓しないことを表します。<br />
      (全ての点のペアの間に線があることが、どの選手も全員と 1 回ずつ同卓していることを表します。重なる線が無い場合、自動的にこちらも達成されます。)<br />
      下図は、少しゴチャゴチャしていますが、完全に重なる線は一つもありません。<br />
      ただし、これは最初のグループの分け方 (線の結び方) をうまく行なったからであり、グループをランダムに分けた場合は、たいてい重なります。<br />
      本手法では、この「最初のグループの分け方」を、プログラムにより探索しました。<br />
    </p>
    <img src="images/3ma_04.png" alt="n = 2 (5 卓 15 人 7 戦) の場合の具体例 (保存した線の配置を全て重ねた図)" width="15%" height="15%" />

    <h4>n が奇数の場合はうまくいかない</h4>

    <p>
      n が奇数 (3, 7, 11, ... 卓) の場合、各円上の点の数 3n+1 は偶数になります。<br />
      その場合、円のちょうど反対側に位置する点を結ぶ線が (回転操作前～最後の操作後のどこかで) 必要です。<br />
      しかし、この線は半回転 (回転操作を (3n+1) / 2 回) した際に元の線と重なってしまいます。<br />
      下図は n = 1 (3 卓 9 人 4 戦) の例です。(赤線は厳密には重なりませんが、結ぶ 2 点が同じなので重なっていると見なせます。)<br />
      よって、n が奇数の場合は上記の方法 ① では卓組を構成できません。<br />
      なお、「全ての偶数の n で構成できること」や「構成できない偶数の n があること」は示せていませんが、n = 2, 4, 6 (5, 9, 13 卓)
      では卓組を構成できることを確認しました。
    </p>
    <img src="images/3ma_05.png" alt="n = 1 (3 卓 9 人 4 戦) の場合の具体例 (線が重なるためうまくいかない)" width="30%" height="30%" />

    <h3>方法 ②</h3>

    <p>
      円と点を使う部分は方法 ① と同様ですが、円を 1 つにしてグループ分けを工夫した方法です。<br />
      まず、円を (1 つ) 描き、円周上に等間隔に 6n+2 個の点を打ちます。円の中心にも点を打ちます。これらの点が選手を表します。<br />
      これらの点を、以下のように 3 個ごとにグループ分けします。
    </p>
    <ol>
      <li>第 1 グループは、一直線上の 3 点とする。</li>
      <li>
        残る (偶数個の) グループは、互いに<b>点対称</b>な (片方のグループの 3 点を半回転させると、もう片方のグループの 3 点と重なる)
        ペアになるように分けていく。
      </li>
    </ol>
    <p>
      各グループに属する点同士を、すべて線で結びます。線で結ばれていることは同卓を表します。<br />
      下図は 3 卓 9 人 の場合に、3 グループに分ける例です。左が全て重ねた図、右が各グループを抜き出した図です。
    </p>
    <img src="images/3ma_06.png" alt="n = 1 (3 卓 9 人 4 戦) の場合の具体例 (線で結び、全て重ねた図)" width="15%" height="15%" />
    <img src="images/3ma_07.png" alt="n = 1 (3 卓 9 人 4 戦) の場合の具体例 (各グループを抜き出した図)" width="30%" height="30%" />

    <p>
      全て重ねた図について、線だけを、時計回りに <b>1 / (6n+2) だけ</b>回転させます。<br />
      この操作を 3n 回行い、操作前・1 回目の操作後・2 回目の操作後・...・3n 回目の操作後、の合計 (3n+1) パターンの線の配置を保存します。<br />
      1 回目の操作後の線の配置は 2 戦目の卓組を、2 回目の操作後の線の配置は 3 戦目の卓組を表します。<br />
      方法 ① では合計で 1 回転させていた (*) のに対し、こちらの方法では<b>半回転で終了</b> (*)
      となります。半回転させると、操作前と同じ線の配置になります。<br />
      (*) 厳密には、回転し切る直前で終了しています。
    </p>
    <img src="images/3ma_08.png" alt="n = 1 (3 卓 9 人 4 戦) の場合の具体例 (回転の操作の図)" width="50%" height="50%" />

    <p>
      保存した線の配置 ((3n+1) パターン)
      を全て重ねます。この際に、完全に重なる線が一つも無いことが、どの選手も同じ相手と複数回同卓しないことを表します。<br />
      (全ての点のペアの間に線があることが、どの選手も全員と 1 回ずつ同卓していることを表します。重なる線が無い場合、自動的にこちらも達成されます。)<br />
      下図は、完全に重なる線は一つもありません。<br />
      ただし、これは最初のグループの分け方 (線の結び方) をうまく行なったからであり、グループをランダムに分けた場合は、たいてい重なります。<br />
      本手法では、この「最初のグループの分け方」を、プログラムにより探索しました。<br />
    </p>
    <img src="images/3ma_09.png" alt="n = 1 (3 卓 9 人 4 戦) の場合の具体例 (保存した線の配置を全て重ねた図)" width="15%" height="15%" />

    <h4>うまくいく n の条件</h4>

    <p>
      n を 4 で割った余りが 2 か 3、すなわち n = 2, 3, 6, 7, 10, 11, ... (5, 7, 13, 15, 21, 23, ... 卓) の場合は、上記の方法 ②
      では卓組を構成できないことが証明できます。
    </p>
    <details>
      <summary>証明</summary>
      <p>
        円周上で隣接する 2 個の点 (黒丸) で区切られる弧の長さを 1 としたとき、長さ a の弧を作る 2 個の点を結ぶ赤線を線 a と呼ぶことにします。<br />
        線 1, 2, ..., 3n の 3n 本を (端点が点上にくるように) 置いて、合計 n 個の三角形を作れることが、上記の方法で卓組を構成できる必要条件です。<br />
        (実際にはさらなる追加条件が必要です。線 1, 2, ..., 3n の 3n 本をもう 1 セット置いて、それらでも n
        個の三角形を作り、さらに図形全体が点対称になっている必要があります。)<br />
      </p>
      <img src="images/3ma_10.png" alt="n = 1 (3 卓 9 人 4 戦) の場合の具体例 (保存した線の配置を全て重ねた図)" width="30%" height="30%" />
      <p>
        また、線 a, b, c で三角形を作れる条件は、a, b, c のうち 1 個以下にマイナス符号を付けて足し合わせたもののいずれか (a+b+c, -a+b+c, a-b+c, a+b-c
        のいずれか) が 6n+2 (円上の点の数) の倍数になることです。<br />
        よって、以下の問題を解けることが必要です。<br />
        「整数 1, 2, ..., 3n のうち 0 個以上 n 個以下にマイナス符号を付けてよいとき、総和を 6n+2 の倍数にできるか？」...(A)<br />
        ここで、各整数にマイナス符号をいくつつけても、総和の偶奇は変わりません (a にマイナスをつけると総和は 2a (偶数) だけ減少するため)。<br />
        6n+2 は偶数なので、(A) が解けるためには総和 1 + 2 + ... + 3n = 3n(3n+1)/2 が偶数である必要があります。<br />
        n = 2k, 2k+1 (k は整数) と場合分けして計算すると、どちらの場合も k と総和の偶奇が一致することが示せます。<br />
        従って、k が奇数である場合、すなわち n を 4 で割った余りが 2 か 3 である場合は、総和が奇数となり、(A)
        を解けず、必要条件を満たせないため、上記の方法 ② では卓組を構成できません。
      </p>
    </details>
    <p>
      なお、n を 4 で割った余りが 0 か 1 の場合「全てのそのような n で構成できること」や「構成できないそのような n があること」は示せていませんが、n =
      12 (25 卓) までは卓組を構成できることを確認しました。
    </p>

    <h2>補足</h2>
    <ul>
      <li>
        この円と点を使うアイデアは、以前から存在しているものです。私は<a
          href="https://web.archive.org/web/20150906205536/http://www004.upp.so-net.ne.jp/s_honma/kirkman/kirkman.htm"
          >こちらのサイト (リンクはアーカイブ)</a
        >
        で知り、卓数を変える・円を 1 つにするなど拡張させて使用してみました。
      </li>
      <li>
        当サイトに掲載している卓組は、上記の方法で作成した後に、以下の操作を複数回行っている場合があります。
        <ul>
          <li>卓番号の入れ替え (例: 1 戦目の卓番号 1 を 2 に、2 を 3 に、3 を 1 に全て書き換えている)</li>
          <li>選手番号の入れ替え</li>
          <li>対戦番号の入れ替え</li>
        </ul>
      </li>
      <li>今後、それぞれの手法のソースコード (Python) とその実行時間を掲載する予定です。</li>
    </ul>

    <br />
    <a href="index.html#3g_kojin_sen">卓組一覧「3人麻雀用 個人戦・3人チーム戦用」へ戻る</a>
  </body>
</html>
