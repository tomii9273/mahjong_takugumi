<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="keyword" content="麻雀, 麻将, 大会, 卓組, 組み合わせ" />
    <title>総当たり戦 卓組作成方法 - 麻雀大会用卓組表</title>
  </head>
  <body bgcolor="#e0ffe0">
    <h1>総当たり戦 卓組作成方法</h1>

    <h2>条件</h2>
    <ul>
      <li>3n+1 卓 12n+4 人の選手がいる。</li>
      <li>4n+1 回の対戦を行う。</li>
      <li>どの選手も、全対戦を行うと (自分以外の) 全員とちょうど 1 回ずつ同卓できる。</li>
      <li>どの選手も、同じ相手と複数回同卓しない。</li>
    </ul>
    <p>
      卓数が「3n+1」以外の場合は、対戦数にかかわらず、3, 4 番目の条件を同時に満たすことはできません。(自分以外の選手の総数が 3 (= 1
      対戦で同卓できる人数) で割り切れないため。)
    </p>

    <h2>方法</h2>

    <p>
      図を使って、卓組を構成していきます。<br />
      まず、大中小 1 つずつの同心円を描きます。各円周を 4n+1 等分するように、点を打ちます。円の中心にも点を打ちます。<br />
      合計 12n+4 個の点を打ちました。これらの点が選手を表します。<br />
      下図は、n = 1 (4 卓 16 人 5 戦) の場合の例です。各円周を 5 等分しています。
    </p>
    <img src="images/souatari_00.png" alt="n = 1 (4 卓 16 人 5 戦) の場合の具体例 (円を描き、点を打った図)" width="15%" height="15%" />

    <p>
      これらの点について、4 個ごとにグループ分けします。<br />
      各グループに属する点同士を、すべて線で結びます。<br />
      線で結ばれていることは同卓を表します。<br />
      下図は 4 卓 16 人 の場合に、4 グループに分ける例です。上段が全て重ねた図、下段が各グループを抜き出した図です。
    </p>
    <img src="images/souatari_01.png" alt="n = 1 (4 卓 16 人 5 戦) の場合の具体例 (線で結び、全て重ねた図)" width="15%" height="15%" /><br />
    <img src="images/souatari_02.png" alt="n = 1 (4 卓 16 人 5 戦) の場合の具体例 (各グループを抜き出した図)" width="50%" height="50%" />

    <p>
      全て重ねた図について、<b>線だけ</b>を、時計回りに 1 / (4n+1) だけ回転させます。<br />
      この操作を 4n 回行い、操作前・1 回目の操作後・2 回目の操作後・...・4n 回目の操作後、の合計 (4n+1) パターンの線の配置を保存します。<br />
      1 回目の操作後の線の配置は 2 戦目の卓組を、2 回目の操作後の線の配置は 3 戦目の卓組を表します。
    </p>
    <img src="images/souatari_03.png" alt="n = 1 (4 卓 16 人 5 戦) の場合の具体例 (回転の操作の図)" width="50%" height="50%" />

    <p>
      保存した線の配置 ((4n+1) パターン)
      を全て重ねます。この際に、完全に重なる線が一つも無いことが、どの選手も同じ相手と複数回同卓しないことを表します。<br />
      (全ての点のペアの間に線があることが、どの選手も全員と 1 回ずつ同卓していることを表します。重なる線が無い場合、自動的にこちらも達成されます。)<br />
      下図は、少しゴチャゴチャしていますが、完全に重なる線は一つもありません。<br />
      ただし、これは最初のグループの分け方 (線の結び方) をうまく行なったからであり、グループをランダムに分けた場合は、たいてい重なります。<br />
      本手法では、この「最初のグループの分け方」を、プログラムにより工夫して探索しました。<br />
      「全ての n で解が存在すること」や「解が存在しない n があること」は示せていませんが、n = 13 (40 卓) までは解が存在することを確認しました。
    </p>
    <img src="images/souatari_04.png" alt="n = 1 (4 卓 16 人 5 戦) の場合の具体例 (保存した線の配置を全て重ねた図)" width="15%" height="15%" />

    <h2>ソースコード</h2>
    <p>
      <a href="https://github.com/tomii9273/takugumi_code/blob/master/souatarisen.py">GitHub に掲載しています。</a><br />
      何をしているかが分かりにくいものになっているので、今後リファクタやコメントの追加を行う予定です。
    </p>

    <h2>補足</h2>
    <ul>
      <li>
        この円と点を使うアイデアは、以前から存在しているものです。私は<a
          href="https://web.archive.org/web/20150906205536/http://www004.upp.so-net.ne.jp/s_honma/kirkman/kirkman.htm"
          >こちらのサイト (リンクはアーカイブ)</a
        >
        で知り、4 人ゲームで使用してみました。
      </li>
      <li>
        当サイトに掲載している卓組は、上記の方法で作成した後に、以下の操作を複数回行っている場合があります。
        <ul>
          <li>卓番号の入れ替え (例: 1 戦目の卓番号 1 を 2 に、2 を 3 に、3 を 1 に全て書き換えている)</li>
          <li>選手番号の入れ替え</li>
          <li>対戦番号の入れ替え</li>
        </ul>
      </li>
      <li>今後、探索の工夫点などの説明も追加する予定です。</li>
    </ul>

    <br />
    <a href="index.html#souatari_sen">卓組一覧「総当たり戦用」へ戻る</a>
  </body>
</html>
